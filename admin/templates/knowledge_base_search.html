{% extends "base.html" %}

{% block title %}Поиск по базе знаний{% endblock %}

{% block content %}
<div class="container mt-4">
    <h1 class="mb-4">Поиск по базе знаний</h1>
    <form method="get" action="/kb-search" class="mb-4">
        <div class="input-group">
            <input type="text" class="form-control" name="query" placeholder="Введите запрос..." value="{{ query or '' }}" required>
            <button class="btn btn-primary" type="submit">
                <i class="fas fa-search"></i> Найти
            </button>
        </div>
    </form>
    {% if error %}
        <div class="alert alert-danger">Ошибка: {{ error }}</div>
    {% endif %}
    {% if query and not results %}
        <div class="alert alert-warning">Нет результатов по запросу <b>{{ query }}</b></div>
    {% endif %}
    {% if results %}
        <h5>Результаты для: <b>{{ query }}</b></h5>
        <div class="list-group mt-3">
            {% for res in results %}
            <div class="list-group-item mb-3">
                <h6>{{ res.title }}</h6>
                <div class="mb-2 text-muted" style="font-size: 0.9em;">Файл: {{ res.file_path }}</div>
                <div style="white-space: pre-line;">{{ res.content }}</div>
                <div class="mt-2"><span class="badge bg-info">Релевантность: {{ '%.3f'|format(res.score) }}</span></div>
            </div>
            {% endfor %}
        </div>
    {% endif %}
</div>
{% endblock %} 